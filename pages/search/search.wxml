<view class="page-container">
  <!-- 渐变背景 -->
  <view class="gradient-header"></view>

  <!-- 搜索区域 -->
  <view class="search-area" style="padding-top: {{statusBarHeight + 10}}px;">
    <view class="back-icon" bindtap="handleBack">
      <image src="https://miniknowledge.9000aigc.com/assets/icons/back (1).png" mode="aspectFit"></image>
    </view>
    <view class="search-container">
      <input class="search-input" 
        placeholder="请输入关键词搜索" 
        placeholder-class="placeholder-style"
        value="{{keyword}}"
        bindinput="onSearchInput"
        bindconfirm="handleSearch"
        confirm-type="search"
        focus="{{true}}"
      />
      <button class="search-btn" bindtap="handleSearch">搜索</button>
    </view>
  </view>

  <!-- 筛选条件区域 -->
  <view class="filter-area">
    <!-- 一级筛选标签 -->
    <scroll-view scroll-x class="filter-scroll">
      <view class="filter-tags">
        <view class="filter-tag {{currentFilter === '1' ? 'active' : ''}}" 
              bindtap="toggleDropdown" data-type="1">
          平台
          <image class="arrow-icon" 
                 src="{{currentFilter === '1' ? 'https://miniknowledge.9000aigc.com/assets/icons/down (4).png' :  'https://miniknowledge.9000aigc.com/assets/icons/down (3).png'}}" 
                 mode="aspectFit"></image>
        </view>
        <view class="filter-tag {{currentFilter === '2' ? 'active' : ''}}" 
              bindtap="toggleDropdown" data-type="2">
          流量形态
          <image class="arrow-icon" 
                 src="{{currentFilter === '2' ? 'https://miniknowledge.9000aigc.com/assets/icons/down (4).png' :  'https://miniknowledge.9000aigc.com/assets/icons/down (3).png'}}" 
                 mode="aspectFit"></image>
        </view>
        <view class="filter-tag {{currentFilter === '3' ? 'active' : ''}}" 
              bindtap="toggleDropdown" data-type="3">
          行业
          <image class="arrow-icon" 
                 src="{{currentFilter === '3' ? 'https://miniknowledge.9000aigc.com/assets/icons/down (4).png' :  'https://miniknowledge.9000aigc.com/assets/icons/down (3).png'}}" 
                 mode="aspectFit"></image>
        </view>
        <view class="filter-tag {{currentFilter === '4' ? 'active' : ''}}" 
              bindtap="toggleDropdown" data-type="4">
          来源
          <image class="arrow-icon" 
                 src="{{currentFilter === '4' ? 'https://miniknowledge.9000aigc.com/assets/icons/down (4).png' :  'https://miniknowledge.9000aigc.com/assets/icons/down (3).png'}}" 
                 mode="aspectFit"></image>
        </view>
      </view>
    </scroll-view>

    <!-- 二级筛选下拉菜单 -->
    <view class="dropdown-menu" wx:if="{{showDropdown}}">
      <view class="dropdown-content">
        <view class="dropdown-grid">
          <block wx:for="{{filterOptions[currentFilter]}}" wx:key="id">
            <view class="dropdown-item {{item.selected ? 'selected' : ''}}" 
                  bindtap="selectOption" data-index="{{index}}">
              {{item.name}}
            </view>
          </block>
        </view>
      </view>
    </view>
  </view>

  <!-- 修改搜索结果列表区域 -->
  <scroll-view class="search-results" scroll-y bindscrolltolower="loadMore">
    <!-- 搜索结果 -->
    <block wx:if="{{keyword && hasSearched}}">
      <block wx:if="{{searchResults.length > 0}}">
        <view class="article-list">
          <view wx:for="{{searchResults}}" wx:key="id">
            <article-item 
              article="{{item}}" 
              bindloadmore="loadMore"
            />
          </view>
        </view>
      </block>
      <block wx:else>
        <view class="no-result">暂无搜索结果</view>
      </block>
    </block>
    
    <!-- 默认文章列表 -->
    <block wx:else>
      <view class="article-list">
        <view wx:for="{{articles}}" wx:key="id" class="article-item" bindtap="navigateToDetail" data-id="{{item.id}}">
          <image class="article-image" src="{{item.coverImage}}" mode="aspectFill"></image>
          <view class="article-content">
            <view class="article-title">{{item.title}}</view>
            <text class="article-time">{{item.createTime}}</text>
          </view>
        </view>
      </view>
      <view wx:if="{{hasMore}}" class="load-more" bindtap="loadMore">加载更多...</view>
    </block>
  </scroll-view>
</view> 