<!-- 抽屉式侧边栏 -->
<view class="sidebar-overlay {{isSidebarShow ? 'show' : ''}}" bindtap="hideSidebar"></view>
<view class="left-panel sidebar {{isSidebarShow ? 'show' : ''}}" style="padding-top: {{statusBarHeight}}px;">
  <scroll-view scroll-y="true" class="left-scroll" style="height: calc(100vh - {{statusBarHeight}}px);">
    <view wx:for="{{leftList}}" wx:key="id"
          class="left-item {{item.id === currentLeftId ? 'active' : ''}}"
          bindtap="onLeftItemTap" data-id="{{item.id}}">
      {{item.name}}
    </view>
  </scroll-view>
</view>

<view class="page-container">
  <!-- 添加渐变背景 -->
  <view class="gradient-header"></view>
  
  <!-- 自定义导航栏 -->
  <view class="custom-nav" style="padding-top: {{statusBarHeight}}px; ">
    <view class="nav-content" style="height: {{navBarHeight}}px;">
      <view class="back-icon" bindtap="handleBack">
        <image src="https://miniknowledge.9000aigc.com/assets/icons/back (1).png" mode="aspectFit"></image>
      </view>
      <view class="nav-title">{{categoryName}}</view>
    </view>
    
    <!-- 添加搜索框 -->
    <view class="search-container">
      <view class="search-box">
        <image class="search-icon" src="https://miniknowledge.9000aigc.com/assets/icons/search.png" mode="aspectFit"></image>
        <input class="search-input" 
          placeholder="请输入关键词搜索" 
          placeholder-class="placeholder-style"
          value="{{keyword}}"
          bindinput="onSearchInput"
          bindconfirm="handleSearch"
          confirm-type="search"
        />
      </view>
    </view>
  </view>
  
  <!-- 主要内容区域 -->
  <view class="main-content" style="padding-top: {{statusBarHeight + navBarHeight + 60}}px;">
    <!-- 右侧面板 -->
    <view class="right-panel">
      <scroll-view scroll-y="true" class="right-scroll" style="height: {{scrollHeight}}px;" bindscrolltolower="loadMore">
        <!-- 标签区域 -->
        <view class="tags-container" wx:if="{{currentTags.length > 0}}">
          <block wx:for="{{currentTags}}" wx:key="id">
            <view wx:if="{{item.id !== 'all' || articles.length > 0}}"
                  class="tag-item {{item.id === currentTagId ? 'active' : ''}}"
                  bindtap="onTagTap"
                  data-id="{{item.id}}">
              {{item.name}}
            </view>
          </block>
        </view>

        <!-- 文章列表区域 -->
        <view class="article-container">
          <view wx:for="{{articles}}"
                wx:key="id"
                class="article-item"
                bindtap="onArticleTap"
                data-index="{{index}}">
            <image class="article-image" src="{{item.coverImage}}" mode="aspectFill"></image>
            <view class="article-content">
              <view class="article-title">{{item.title}}</view>
              <!-- 添加标签显示区域 -->
              <view class="article-tags" wx:if="{{item.tags && item.tags.length > 0}}">
                <view wx:for="{{item.tags}}" wx:key="*this" wx:for-item="tag" class="article-tag">
                  {{tag}}
                </view>
              </view>
              <text class="article-time">{{item.createTime}}</text>
            </view>
          </view>
        </view>

        <!-- 加载更多/无数据提示 -->
        <view wx:if="{{loading}}" class="load-more">加载中...</view>
        <view wx:elif="{{hasMore}}" class="load-more">上拉加载更多...</view>
        <view wx:elif="{{articles.length > 0 && !hasMore}}" class="load-more">没有更多了</view>
        <view wx:if="{{articles.length === 0 && !loading}}" class="empty-tip">暂无相关文章</view>

      </scroll-view>
    </view>
  </view>
  
  <!-- 悬浮分类按钮 - 只有存在子分类时才显示 -->
  <view wx:if="{{leftList.length > 1}}" class="floating-category-btn" bindtap="toggleSidebar">
    <image src="https://miniknowledge.9000aigc.com/assets/icons/category.png" mode="aspectFit"></image>
  </view>
</view> 